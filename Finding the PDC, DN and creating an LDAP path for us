# Finding the PDC, DN and creating an LDAP path for us
# The below script uses powershell, .NET classes and ADSI to dynamically obtain the full LDAP path for AD enumeration

# Copy the below to a powershell script
# Run powershell instance with powershell -ep bypass
# Execute your new powershell script .\{File name}

# Store the primary domain controller object in the $PDC variable
$PDC =
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name

# Store the Distinguished Name variable into the $DN variable
$DN = ([adsi]'').distinguishedName

# Format our two variables to our desired LDAP path
$LDAP = "LDAP://$PDC/$DN"

# Print our desired LDAP path
$LDAP
